CubeICE
====

Copyright © 2011 CubeSoft, Inc.  
Apache License, Version 2.0 (Apache 2.0)  
support@cube-soft.jp  
https://www.cube-soft.jp/cubeice/

## はじめに

CubeICE は、様々な形式に対応した圧縮・解凍（展開）ソフトです。
圧縮・解凍（展開）したいファイルを選択して右クリックから表示されるコンテキストメニューで
選択するかショートカットにドラッグ&ドロップする事によって圧縮・解凍を行う事ができます。
詳細な利用方法については下記 URL を参照下さい。

* CubeICE ユーザーマニュアル  
  https://docs.cube-soft.jp/entry/cubeice

CubeICE を使用するためには .NET Framework 3.5 以降がインストールされている必要があります（4.7 以降を推奨）。
.NET Framework は、以下の URL からダウンロードして下さい。

* Download .NET Framework  
  https://dotnet.microsoft.com/download/dotnet-framework

### アンインストール時の注意

CubeICE はエクスプローラーなどの右クリックから表示されるコンテキストメニューを
拡張していますが、この拡張のためのプログラムがアンインストール時に
（エクスプローラーなどが使用しているなどの関係で）削除されない事があります。
この場合は、コンピュータの再起動後に該当のプログラムを選択して直接削除して下さい。
該当プログラムは、32bit 版の場合は cubeicectx-vXX.dll、
64bit 版の場合は cubeicectx-vXX-x86.dll および cubeicectx-vXX-x64.dll です。

### 問題が発生した場合

CubeICE は、以下のフォルダに実行ログを出力しています（%UserName% は、ログオン中のユーザ名に置換）。  
```C:\Users\%UserName%\AppData\Local\CubeSoft\CubeIce\Log```  
問題が発生した時は、これらのログを添付して support@cube-soft.jp までご連絡をお願いいたします。

## 利用ライブラリ

CubeICE は、以下のライブラリを利用しています。
それぞれのライブラリについては、記載した URL から取得することができます。

* 7-Zip
    - GNU Lesser General Public License
    - https://www.7-zip.org/
* AlphaFS
    - MIT License
    - https://alphafs.alphaleonis.com/
    - https://www.nuget.org/packages/AlphaFS/
* NLog
    - 3-clause BSD License
    - https://nlog-project.org/
    - https://www.nuget.org/packages/NLog/
* Managed NTFS Data Streams
    - Apache 2.0 License
    - https://github.com/Emzi0767/Managed-NTFS-Data-Streams
* AsyncBridge (net35)
    - MIT License
    - https://omermor.github.io/AsyncBridge/
    - https://www.nuget.org/packages/AsyncBridge/

## バージョン履歴

* 2024-01-25 version 3.2.0
    - ファイル入出力関係の処理を改善
    - 設定画面で Enter キー押下時に OK と認識されないように修正
* 2023-08-01 version 3.1.0
    - ZoneID をサポートしないファイルシステムに解凍した場合にエラーとなる不具合を修正
    - 作業フォルダーの初期設定をシステムの規定値に変更
    - 7-Zip を 23.01 相当に更新
    - 内部処理を改善
* 2023-04-05 version 3.0.1
    - 読み取り専用フラグのあるファイルが含まれる場合、ZoneID が伝搬できずに解凍処理が失敗する不具合を修正
* 2023-04-03 version 3.0.0
    - ZoneID を伝搬するように修正 (Mark of the Web)
    - 設定画面のファイル関連付け項目にヘルプボタンを追加
* 2022-12-23 version 2.2.1
    - 圧縮時に 2 階層以上のフォルダー構造が消失する不具合を修正
* 2022-12-16 version 2.2.0
    - ファイル関連付けに関する処理を一部改善
    - 進捗状況の表示方法を改善
    - 名前を付けて保存ダイアログに関する不具合を修正
* 2022-11-11 version 2.1.0
    - エラー発生時に無視して処理を続行する機能を追加
    - 圧縮・解凍中に発生するエラーを改善
    - 7-Zip を 22.01 相当に更新
* 2022-07-07 version 2.0.0
    - 推奨動作環境を .NET Framework 4.7 以降に変更
    - 7-Zip を 22.00 相当に更新
    - 圧縮レベルに関する設定を追加
    - ドットで始まるフォルダーの圧縮時にエラーになる不具合を修正
    - サイレントインストールに関する挙動を修正
* 2022-02-25 version 1.1.1
    - 一部の Zip ファイルの解凍時に文字化けする不具合を修正
* 2022-01-21 version 1.1.0
    - ファイルの関連付け用アイコンの選択機能を追加
    - コマンドライン体系を整備
    - 7-Zip を 21.07 相当に更新
* 2021-10-29 version 1.0.1
    - 場所を指定して解凍メニュー選択時の不具合を修正
    - 更新通知機能を改善
* 2021-10-15 version 1.0.0
    - アイコンやメイン画面の外観を修正
    - 圧縮してメール送信機能を削除
    - ツールチップ表示の初期設定を無効に変更
    - ファイル操作方法に関する設定を追加
    - 作業用フォルダーに関する設定を追加
    - 圧縮ファイルに対して Windows 標準の関連付けで解凍できるように修正
    - 読み取り専用ファイルが含まれる場合に解凍に失敗する不具合を修正
    - パスワード入力エラー時に 0 バイトのファイルが生成される挙動を改善
    - フォルダーに対して上書き確認ダイアログを表示しないように修正
    - 解凍後に開くフォルダーの決定方法を改善
    - テキストボックスが空の時にファイル保存用ダイアログを表示するとエラーとなる不具合を修正
    - ファイル名に使用できない文字をテキストボックスに入力できないように修正
    - ファイル保存用ダイアログの拡張子に関する処理を改善
    - その他、多数の修正
* 2020-06-16 version 0.10.0β
    - ログ出力用ライブラリを log4net から NLog に変更
    - ライセンスを Apache 2.0 に変更
* 2020-05-01 version 0.9.2β
    - 高 DPI 設定時の表示方法を修正
    - 64bit 版作成された自己解凍形式の圧縮ファイルが 32bit 版 Windows で解凍できない不具合を修正
    - CubeICE ユーザーマニュアルを Web 版に移行
* 2019-04-05 version 0.9.1β
    - 特定の条件でファイルの関連付け設定が機能しない不具合を修正
    - ファイル一覧の表示機能を完全に無効化できるように修正
    - タスクバーの進捗表示機能に関する不具合を修正
    - パスワード入力画面での不具合を修
    - 未対応形式のファイルが指定された時のエラーメッセージを修正
    - 7-Zip 19.00 の修正を適用
* 2018-05-25 version 0.9.0β
    - コンテキストメニューのカスタマイズ画面を再実装
    - 自己解凍形式の圧縮ファイルを CubeICE 経由で解凍した時にエラーとなる不具合を修正
    - タスクバーに進捗状況を表示するように修正
    - デバッグログの出力を抑制するように修正
    - 圧縮時における文字コードの自動変換方法を変更
    - 7-Zip 18.05 の修正を適用
* 2018-02-23 version 0.8.5β
    - 複数の圧縮ファイルが指定された時の解凍方法に関するオプションを追加
    - 特定の条件下で処理をキャンセルした時に一時ファイルが削除されない不具合を修正
    - 拡張子以外の個所にピリオドを含むファイルの扱いを修正
    - 文字コードの推測精度を改善
    - 圧縮処理の詳細設定での表示に関する不具合を修正
    - 7-Zip 18.01 の修正を適用
* 2018-12-11 version 0.8.4β
    - 同名の圧縮ファイルが存在する時にダイアログを表示するかどうかのオプションを追加
    - 一部のユーザ設定が反映されない不具合を修正
    - 経過時間および残り時間の表示に関する不具合を修正
* 2017-12-04 version 0.8.3β
    - 名前を付けて保存ダイアログの表示上の問題を修正
    - 右クリックにドラッグ&ドロップで圧縮時に保存されるフォルダを修正
    - 文字コードの推測精度を改善
* 2017-10-11 version 0.8.2β
    - 特定の GZip, BZip2, XZ 形式の圧縮ファイルの解凍に失敗する不具合を修正
    - 解凍時に複数の圧縮ファイルが指定された時の挙動を修正
    - 空のフォルダを含む圧縮ファイルを解凍した時に解凍結果に空のフォルダが反映されない不具合を修正
* 2017-09-20 version 0.8.1β
    - TAR を含圧縮ファイルの解凍処理を修正
    - マルチボリューム形式の圧縮ファイルの解凍処理を修正
    - 圧縮時にファイル名を UTF-8 に変換するオプションを追加
    - コンテキストメニューに XZ 形式を追加
* 2017-08-21 version 0.8.0β
    - .NET Framework を利用する形に変更
    - パスワードに特定の文字が使用されていた場合に解凍できない不具合を修正
    - 特定の条件下で作業領域からの移動に失敗する不具合を修正
    - GUI の改善
    - その他、多数の修正
* 2016-05-31 version 0.7.1β
    - セキュリティ上の問題に対応
* 2013-02-05 version 0.7.0β
    - Windows 8 に対応
* 2012-09-21 version 0.6.8β
    - 「起動時にアップデートを確認する」の設定に関わらず、スタートアップの登録、削除が行われない不具合を修正
    - コンテキストメニューの設定が反映されない不具合を修正
* 2012-08-07 version 0.6.7β
    - CubeICE 詳細設定 (cubeice-detail.exe) を作成
    - ユーザ設定を保存するためのデータ構造を変更
    - ショートカットのカスタマイズ機能を追加
    - コンテキストメニューのカスタマイズ機能を強化
    - マウスの右クリックによるドラッグ&ドロップ時に表示されるコンテキストメニューのカスタマイズ機能を追加
    - CubeICE 設定に「適用」ボタンを追加
* 2012-05-15 version 0.6.6β
    - MacOS で圧縮したファイルを解凍すると濁点が文字化けする不具合を修正
    - ファイル名に Windows で使用できない文字 ('/', '*', '"', '<', '>', '|', '?', ':' の 8 種類）が存在する場合に解凍に失敗する不具合を修正
    - コンテキストメニューから圧縮を選択した場合、フィルタリングが機能しない不具合を修正
    - TAR アーカイブの中に同名の TAR ファイルが存在する場合、解凍に失敗する不具合を修正
    - 単一の TAR ファイルを詳細設定から tgz 形式で圧縮すると圧縮ファイルが生成されない不具合を修正
    - 64ビット版 Windows 上で 32ビット版のファイラーを使用した場合、コンテキストメニューに CubeICE の各種メニューが表示されない不具合を修正
    - 圧縮時に出力ファイル名を指定する際、拡張子の入力が省略された場合に選択されている圧縮形式に対応する拡張子を補うように修正
    - エクスプローラ等のツールチップで表示されるファイルサイズをサイズに応じて KB、MB と言った単位で表示されるように修正
    - ファイルを作成できないフォルダが保存先に指定された場合に、エラーメッセージを表示するように修正
* 2011-10-26 version 0.6.5β
    - CubeICE 設定のレイアウトを解像度 800x600 の画面内に収まるように修正
    - 複数の圧縮ファイルを選択して解凍を実行した際に、全ての解凍処理が終了するまでプログレスバーが表示され続ける不具合を修正
    - 圧縮ファイルに保存されているコメント情報が原因で解凍に失敗する不具合を修正
    - 「フォルダを自動生成する」オプションに「単一ファイルの場合は生成しない」サブオプションを追加
* 2011-10-05 version 0.6.4β
    - パスワード付ファイルを解凍する際にエラーが発生する不具合を修正
    - 右クリックによるドラッグ&ドロップ時に、「ここに解凍」を選択した時の解凍先を変更
    - 作業領域を解凍先フォルダに変更
* 2011-09-22 version 0.6.3β
    - CubeICE で圧縮したファイルを別のプログラムで解凍した際に文字化けが発生する不具合を修正
    - TAR 関連のファイル形式に圧縮したときに発生する不具合を修正
* 2011-09-06 version 0.6.2β
    - 「ファイルを開く」で使用するプログラムを指定できるように変更
    - 「圧縮/解凍」タブの「指定したフォルダ」にドライブ直下 (C:\ 等) を指定した場合に発生する不具合を修正
    - 「圧縮/解凍」タブの「指定したフォルダ」のテキストボックスを直接修正した場合に結果が反映されない不具合を修正
    - 圧縮の詳細設定で、出力ファイルパスをテキストボックスから直接修正した後、ファイルの種類を変更した場合にファイル名が元に戻る不具合を修正
    - フォルダを指定して TAR 関連のファイル形式に圧縮したときにエラーが発生する不具合を修正
    - Windows 上で許されていない名前のファイルが存在した場合に、強制的にリネームして解凍するように修正
    - CubeICE 設定で、特定の条件下で設定が正しく保存されない不具合を修正
    - CubeICE 設定の「指定したフォルダ」を選択する際に、「マイコンピュータ」を選択不可能なように修正
* 2011-08-12 version 0.6.1β
    - ファイル名の文字エンコードの推測に失敗した場合の処理を修正
    - 圧縮時、同名のファイルが存在した場合に発生する不具合を修正
    - 特定の環境下でサイズの大きい圧縮ファイルを解凍する際に、エラーが発生する不具合を修正
    - TAR 関連 (*.tar.gz, *.tar.bz2) のファイル形式へ圧縮する際に発生する不具合を修正
    - デバッグ用のログを出力するオプションを追加
* 2011-07-04 version 0.6.0β
    - 制限ユーザの場合に CubeICE の設定が行えない不具合を修正
    - フィルタリング文字列に指定できない文字列をチェックするように修正
    - Mac PC で作成されたアーカイブを解凍する際の文字コードの扱い方を修正
    - キャンセル時に一時ファイルが残る問題を修正
    - 右クリックで表示されるコンテキストメニューを詳細にカスタマイズできるように変更
    - 作成可能な形式に自己解凍形式 (exe) を追加
* 2011-05-16 version 0.5.2β
    - CubeICE 設定の不具合を修正
* 2011-05-12 version 0.5.1β
    - カンマ(,)の含まれる圧縮ファイルを解凍すると不具合が発生する問題を修正
    - パスワード付圧縮ファイルの解凍に関連する問題を修正
    - ドラッグ&ドロップのコンテキストメニューにおける不具合を修正
    - 特定のファイル名の付いたファイルを圧縮する際の，自動的に決定される圧縮ファイル名を修正
    - 圧縮の詳細設定において，圧縮形式が tar の場合でも圧縮レベルが選択できる問題を修正
    - 関連付けに JAR を追加
    -「全て選択」、「全て解除」ボタンを追加
* 2011-04-08 version 0.5.0β
    - 「追加圧縮」機能を追加
    - 右クリックによるドラッグ&ドロップで表示されるコンテキストメニューに対応
    - CubeICE 設定の「起動時にアップデートを確認する」チェックボックスに関連する問題を修正
    - 特定の条件下でパスワード付き圧縮ファイルの解凍に失敗する問題を修正
* 2011-03-29 version 0.4.0β
    - プログレスバーの精度を改善
    - プログレスバーに処理時間，残り時間，処理済ファイル数，総ファイル数の情報を追加
    - プログレスバーに一時停止機能を追加
    - タスクバーのプログレスバー表示機能を追加（Windows 7 のみ）
    - 解凍時に元ファイルを削除するオプションを追加
    - コンテキストメニューのサブメニュの表示/非表示を選択できるオプションを追加
    - コンテキストメニューの解凍サブメニューにマイドキュメントを追加
    - 解凍時の初期処理に要する時間を改善
    - ある特定の条件下において，圧縮の詳細設定「CPU スレッド数」の設定が圧縮処理時に反映されない問題を修正
* 2011-03-09 version 0.3.3β
    - コンテキストメニュー関連の問題を修正
* 2011-03-08 version 0.3.2β
    - 解凍先フォルダを選択する際の初期選択フォルダを修正
    - エラーメッセージの出力部分を修正
* 2011/02-22 version 0.3.1β
    - 右クリックでコンテキストメニューに表示する際の処理を簡略・高速化
    - Windows XP x64, Windows Vista x64 でコンテキストメニューが表示されない問題を修正
    - 関連付け等の初期設定を cubeice-setting.exe で行うように修正
* 2011-02-14 version 0.3.0β
    - 最初の公開バージョン
